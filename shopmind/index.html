<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShopMind AI - Senior Intelligence</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --primary: #8b5cf6;
            /* Violet */
            --secondary: #06b6d4;
            /* Cyan */
            --accent: #f43f5e;
            /* Rose */
            --success: #10b981;
            /* Emerald */
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --glass-bg: rgba(30, 41, 59, 0.8);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            box-sizing: border-box;
            padding: 0;
            margin: 0;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Outfit', sans-serif;
            overflow-x: hidden;
            background-image: radial-gradient(circle at 10% 20%, rgba(139, 92, 246, 0.15) 0%, transparent 20%), radial-gradient(circle at 90% 80%, rgba(6, 182, 212, 0.15) 0%, transparent 20%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            transition: 0.3s;
        }

        .glass:hover {
            transform: translateY(-3px);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }

        .logo {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-family: inherit;
            transition: 0.2s;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }

        .btn-primary:hover {
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.5);
            transform: scale(1.02);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 24px;
            margin-bottom: 24px;
        }

        .metric-card {
            padding: 24px;
            display: flex;
            flex-direction: column;
        }

        .metric-val {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 10px 0;
        }

        .metric-label {
            color: var(--text-muted);
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 1px;
        }

        /* AI Panel */
        #agent-panel {
            padding: 30px;
            margin-bottom: 30px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.05), rgba(6, 182, 212, 0.05));
            border: 1px solid var(--primary);
        }

        .rec-item {
            padding: 20px;
            margin-bottom: 15px;
            border-left-width: 4px;
            border-left-style: solid;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .rec-critical {
            border-left-color: var(--accent);
            background: rgba(244, 63, 94, 0.1);
        }

        .rec-high {
            border-left-color: orange;
            background: rgba(255, 165, 0, 0.1);
        }

        .rec-profit {
            border-left-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        @keyframes scan {
            0% {
                background-position: 0% 50%;
            }

            100% {
                background-position: 100% 50%;
            }
        }

        .analyzing {
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            background-size: 200% 100%;
            animation: scan 1s infinite;
        }

        input,
        select {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--glass-border);
            color: white;
            padding: 8px;
            border-radius: 6px;
            width: 100%;
            margin: 5px 0;
        }

        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th {
            text-align: left;
            color: var(--text-muted);
            padding: 10px;
            font-size: 0.9em;
        }

        td {
            padding: 10px;
            border-top: 1px solid var(--glass-border);
        }
    </style>
</head>

<body>
    <div class="container">
        <header class="header">
            <div class="logo">ShopMind <span style="font-size:0.5em; opacity:0.7">Enterprise</span></div>
            <div class="glass" style="padding:10px 20px; font-size:0.9rem">
                Mode: <b>Senior Architect</b> üöÄ
            </div>
        </header>

        <!-- DATA INPUT SECTION (Simulating external data source) -->
        <div class="glass" style="padding:20px; margin-bottom:30px">
            <h3 style="color:var(--secondary); margin-bottom:15px">üìÇ Historical Data Injection</h3>
            <div style="display:flex; gap:10px; align-items:center flex-wrap:wrap">
                <div style="flex:1">
                    <p style="font-size:0.9rem; color:var(--text-muted); margin-bottom:5px">Paste CSV Data (or use
                        simulated)</p>
                    <textarea id="past-orders-input" rows="2"
                        style="width:100%; background:rgba(0,0,0,0.3); border:1px solid var(--glass-border); color:white; border-radius:8px; padding:10px; font-family:monospace;"
                        placeholder="OrderID, ItemID, Date, Qty, Price..."></textarea>
                </div>
                <button id="action-btn" class="btn btn-primary" onclick="handleDataInjection()">Load Data (CSV or
                    Sim)</button>
            </div>
        </div>

        <!-- AI INTELLIGENCE LAYER -->
        <section id="agent-panel" class="glass">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px">
                <div>
                    <h2 style="font-size:1.8rem; margin-bottom:5px">üß† Cognitive Engine</h2>
                    <p style="color:var(--text-muted)">Analyzing Sales Velocity, Margin & Demand</p>
                </div>
                <button onclick="runAdvancedAnalysis()" class="btn btn-primary">Run Deep Analysis</button>
            </div>
            <div id="ai-output">
                <div
                    style="text-align:center; padding:20px; color:var(--text-muted); border:1px dashed var(--glass-border); border-radius:10px">
                    Waiting for data... Load history to begin.
                </div>
            </div>
        </section>

        <!-- ANALYTICS DASHBOARD -->
        <div class="grid">
            <div class="glass metric-card">
                <div class="metric-label">Projected Monthly Revenue</div>
                <div class="metric-val" id="projected-rev">$0.00</div>
                <div style="color:var(--success); font-size:0.9rem">Based on current velocity</div>
            </div>

            <div class="glass metric-card">
                <div class="metric-label">üèÜ Top Revenue Driver</div>
                <div class="metric-val" id="top-item" style="font-size:1.8rem">Waiting...</div>
                <div id="top-item-val" style="color:var(--secondary); font-size:0.9rem">$0 / month</div>
            </div>

            <div class="glass metric-card" style="grid-column: span 2;">
                <div class="metric-label">Sales Trend</div>
                <div style="height:200px; position:relative;">
                    <canvas id="salesChart"></canvas>
                </div>
            </div>
        </div>

        <!-- INVENTORY INTELLIGENCE -->
        <div class="glass" style="padding:24px">
            <h3 style="margin-bottom:20px">ÔøΩ Smart Inventory Matrix</h3>
            <table id="inv-table">
                <thead>
                    <tr>
                        <th>Item Name</th>
                        <th>Stock</th>
                        <th>Velocity (Daily)</th>
                        <th>Days Left</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Populated by JS -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // --- MOCK DATABASE ---
        let items = [
            { id: "1", name: "Wireless Headphones", stock: 12, cost: 3000, price: 5999 },
            { id: "2", name: "Ergonomic Mouse", stock: 45, cost: 800, price: 1999 },
            { id: "3", name: "Mech Keyboard", stock: 5, cost: 4500, price: 9999 },
            { id: "4", name: "Gaming Monitor", stock: 2, cost: 12000, price: 24999 },
            { id: "5", name: "USB-C Hub", stock: 100, cost: 500, price: 1499 }
        ];

        let history = []; // To be filled with orders
        let velocityMap = {}; // ItemID -> Units sold per day
        let chartInstance = null;

        // --- SENIOR DEV FUNCTIONS ---

        function handleDataInjection() {
            const inputVal = document.getElementById('past-orders-input').value.trim();
            if (inputVal) {
                parseCSV(inputVal);
            } else {
                injectSimulatedHistory();
            }
        }

        function parseCSV(csvText) {
            const btn = document.querySelector('#action-btn');
            btn.innerText = "Parsing...";

            try {
                history = [];
                const lines = csvText.split('\n');
                lines.forEach(line => {
                    // Format: OrderID, ItemID, Date, Qty
                    const parts = line.split(',');
                    if (parts.length >= 4) {
                        const datePart = parts[2].trim();
                        history.push({
                            date: new Date(datePart),
                            itemId: parts[1].trim(),
                            qty: parseInt(parts[3].trim())
                        });
                    }
                });

                calculateMetrics();
                drawChart();
                renderTable();

                btn.innerText = "CSV Loaded ‚úÖ";
                document.getElementById('ai-output').innerHTML = '<div style="text-align:center; color:var(--text-main);">Custom Data Loaded. Ready for Analysis.</div>';
            } catch (e) {
                alert("Error parsing CSV: " + e.message);
                btn.innerText = "Error ‚ùå";
            }
        }

        function injectSimulatedHistory() {
            const btn = document.querySelector('#action-btn');
            btn.innerText = "Generating...";

            // Generate 30 days of fake data
            history = [];
            const today = new Date();
            for (let i = 30; i > 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);

                // Simulate random orders
                const numOrders = Math.floor(Math.random() * 5) + 1;
                for (let j = 0; j < numOrders; j++) {
                    const randomItem = items[Math.floor(Math.random() * items.length)];
                    // Bias: Headphones sell fast, Hubs sell slow
                    if (randomItem.id === "1" && Math.random() > 0.3) {
                        history.push({ date: date, itemId: randomItem.id, qty: 1 });
                    } else if (randomItem.id === "5" && Math.random() > 0.8) {
                        history.push({ date: date, itemId: randomItem.id, qty: 1 });
                    } else {
                        history.push({ date: date, itemId: randomItem.id, qty: 1 });
                    }
                }
            }

            // Calculate Metrics
            calculateMetrics();
            drawChart();
            renderTable();

            btn.innerText = "Simulation Loaded ‚úÖ";
            document.getElementById('ai-output').innerHTML = '<div style="text-align:center; color:var(--text-main);">Data Ingestion Complete. Ready for Analysis.</div>';
        }

        function calculateMetrics() {
            velocityMap = {};
            let revenueMap = {};
            items.forEach(i => {
                velocityMap[i.id] = 0;
                revenueMap[i.id] = 0;
            });

            // Simple avg velocity over 30 days
            history.forEach(order => {
                velocityMap[order.itemId] += order.qty;
            });

            for (let id in velocityMap) {
                // Monthly Velocity
                velocityMap[id] = (velocityMap[id] / 30).toFixed(2); // Units per day
            }

            // Proj Revenue & Top Item
            let dailyRev = 0;
            let maxRev = 0;
            let topItemId = null;

            items.forEach(item => {
                const itemDailyRev = velocityMap[item.id] * item.price;
                dailyRev += itemDailyRev;
                revenueMap[item.id] = itemDailyRev * 30; // Monthly

                if (revenueMap[item.id] > maxRev) {
                    maxRev = revenueMap[item.id];
                    topItemId = item.id;
                }
            });

            document.getElementById('projected-rev').innerText = "‚Çπ" + (dailyRev * 30).toLocaleString('en-IN', { minimumFractionDigits: 2 });

            if (topItemId) {
                const topItem = items.find(i => i.id === topItemId);
                document.getElementById('top-item').innerText = topItem.name;
                document.getElementById('top-item-val').innerText = "Generates ‚Çπ" + maxRev.toLocaleString('en-IN') + " / month";
            }
        }

        function runAdvancedAnalysis() {
            const container = document.getElementById('ai-output');
            container.classList.add('analyzing');
            container.innerHTML = "Processing Algorithms...";

            setTimeout(() => {
                container.classList.remove('analyzing');
                const recs = [];

                items.forEach(item => {
                    const vel = parseFloat(velocityMap[item.id]);
                    const daysLeft = vel > 0 ? (item.stock / vel).toFixed(1) : 999;
                    const profitMargin = ((item.price - item.cost) / item.price) * 100;

                    // 1. Predictive Restock (The "Senior" part)
                    if (daysLeft < 7) {
                        recs.push({
                            type: 'critical',
                            msg: `‚ö†Ô∏è <b>Stockout Risk:</b> ${item.name} will run out in ${daysLeft} days based on current velocity. Reorder immediately.`
                        });
                    }

                    // 2. Profit Optimization (Price Elasticity Simulation)
                    if (vel > 0.5 && profitMargin < 40) {
                        recs.push({
                            type: 'profit',
                            msg: `üí∞ <b>Profit Opportunity:</b> ${item.name} has high velocity (${vel}/day). Suggest increasing price by 10% to boost margin.`
                        });
                    }

                    // 3. Dead Stock Detection
                    if (vel === 0 && item.stock > 10) {
                        recs.push({
                            type: 'high',
                            msg: `ÔøΩ <b>Dead Stock:</b> ${item.name} hasn't sold in 30 days. Liquidate to free up cash flow.`
                        });
                    }
                });

                if (recs.length === 0) recs.push({ type: 'profit', msg: "All systems optimal. Strategy is sound." });

                container.innerHTML = recs.map(r => `
                    <div class="glass rec-item ${r.type === 'critical' ? 'rec-critical' : r.type === 'profit' ? 'rec-profit' : 'rec-high'}">
                        <div>${r.msg}</div>
                        <button class="btn btn-primary" style="font-size:0.8rem">Execute</button>
                    </div>
                `).join('');

            }, 1000);
        }

        function drawChart() {
            const ctx = document.getElementById('salesChart').getContext('2d');

            // Group by date
            const salesByDate = {};
            history.forEach(h => {
                const d = h.date.toLocaleDateString();
                salesByDate[d] = (salesByDate[d] || 0) + 1;
            });

            const labels = Object.keys(salesByDate).slice(-14); // Last 14 days
            const data = Object.values(salesByDate).slice(-14);

            if (chartInstance) chartInstance.destroy();

            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Daily Orders',
                        data: data,
                        borderColor: '#8b5cf6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,0.05)' } },
                        x: { grid: { display: false } }
                    },
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        function renderTable() {
            const tbody = document.querySelector('#inv-table tbody');
            tbody.innerHTML = items.map(item => {
                const vel = parseFloat(velocityMap[item.id] || 0);
                const daysLeft = vel > 0 ? (item.stock / vel).toFixed(0) : "‚àû";
                return `
                    <tr>
                        <td>${item.name}</td>
                        <td style="font-weight:bold">${item.stock}</td>
                        <td>${vel} / day</td>
                        <td style="color:${daysLeft < 7 ? 'var(--accent)' : 'inherit'}">${daysLeft} days</td>
                        <td>
                            <span style="font-size:0.8em; padding:2px 6px; border-radius:4px; background:${daysLeft < 7 ? 'rgba(244,63,94,0.2)' : 'rgba(16,185,129,0.2)'}">
                                ${daysLeft < 7 ? 'CRITICAL' : 'OK'}
                            </span>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Init
        // Don't auto-load history, let user click to "simulate" the experience
    </script>
</body>

</html>